Written by Storlek, many features added by mrsbrisby.
